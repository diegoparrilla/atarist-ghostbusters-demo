	CLR.L -(A7)
	MOVE.W #$20,-(A7)
	TRAP #1
	ADDQ.L #6,A7
	
	BSR REGIS
	BSR LOADSAM
	BMI.S SALIDA  
	DC.W $A00A
CICLICO	BSR TOSAMP
SALIDA	
	BSR REGIS
	CLR.W -(A7)
	TRAP #1


* ESTA RUTINA PERMITE TOCAR LAS SECUENCIAS
* CREADAS CON EL STCUENZER.
* A ESTE PROGRAMA SE DEBE INCLUIR LA LISTA
* DE SAMPLINGS Y LA LISTA DE SECUENCIAS.
* DE CADA LISTA SOBRAN LOS VALORES ULTIMOS
* NULOS EXPECTUANDO UNO.

* (C)1989 RUTINAS Y TABLAS POR EL CANAL 23
TOSAMP
	MOVE.L #SECUENC,A5
	MOVE.L #DIRECC,A6

REPSEQ	MOVE.B (A5)+,D0	;No. DEL SAMPLING
	MOVE.B (A5)+,D1	;Velocidad
	MOVE.L (A5)+,D2 ;Bytes o Espera
	
	TST.B D0
	BEQ PAUSA2
	AND.L #$FF,D0
	SUBQ.L #1,D0
	MULU #8,D0
	MOVE.L (A6,D0.W),A0
	ADD.L #LIBRE,A0
	MOVE.L A0,INICIO
	MOVE.L D2,LONG
	AND.W #$FF,D1
	MOVE.W D1,SPEED
	BSR TSAMPLE
	MOVE.B $FFFFFFC02,D0
	CMP.B #$39,D0
	BNE.S REPSEQ
	RTS

PAUSA2	TST.L D2
	BNE PAUSA3
	RTS
PAUSA3	MOVE.L $4BA,D0
STT	MOVE.L $4BA,D1
	SUB.L D0,D1
	CMP.L D1,D2
	BPL STT
	BRA.S REPSEQ



		
TSAMPLE	LEA SAMPLE1,A2
	MOVE.L INICIO,A0
	MOVE.L A0,A1
	ADD.L LONG,A1
SSAMP	BSR.S PAUSA
	MOVE.B (A0)+,D0
	ANDI.L #$FC,D0
	MOVE.W $0(A2,D0.L),D1
	MOVE.W $2(A2,D0.L),D2
	MOVE.B #8,$FFFF8800
	MOVE.B D2,$FFFF8802
	MOVE.B #9,$FFFF8800
	MOVE.B D1,$FFFF8802
	NOP
	NOP
	NOP
	NOP
	NOP
	NOP
	NOP
	NOP 
	NOP
	NOP
	NOP
	NOP
	NOP
	NOP  
	CMPA.L A1,A0
	BNE.S SSAMP
PAQUI	RTS
PAUSA	MOVE.W SPEED,D0
TURURU	
	DBF D0,TURURU
	RTS
REGIS
	EOR.B #$1,$484
	LEA PSG,A0
REGIS1	MOVE.W (A0)+,D0
	BMI.S PAQUI
	MOVE.B D0,BUF1
	MOVE.W (A0)+,D0
	MOVE.B D0,BUF1+2
	BSR INPSG
	BRA.S REGIS1
	

INPSG	MOVE.B BUF1,D1
	CMPI.B #7,D1
	BNE PROPSG
	MOVE.B D1,$FFFF8800
	MOVE.B $FFFF8800,D2
	ANDI.B #$C0,D2
	OR.B BUF1+2,D2
	MOVE.B D2,$FFFF8802
	RTS
PROPSG	MOVE.B BUF1,$FFFF8800
	MOVE.B BUF1+2,$FFFF8802
	RTS


SAMPLE1	DC.L $00000000,$00020000,$00020001,$00020002,$00030002,$00040001
	DC.L $00040002,$00050002,$00060000,$00060002,$00060003,$00060004
	DC.L $00070002,$00070004,$00070005,$00080002,$00080003,$00080004
	DC.L $00080005,$00090002,$00090003,$00090004,$00090005,$00090006
	DC.L $00090007,$000A0003,$000A0004,$000A0005,$000A0006,$000A0007
	DC.L $000B0000,$000B0001,$000B0002,$000B0004,$000B0005,$000B0006
	DC.L $000B0007,$000B0008,$000B0008,$000B0009,$000B0009,$000C0000
	DC.L $000C0001,$000C0002,$000C0003,$000C0004,$000C0005,$000C0006
	DC.L $000C0008,$000C0008,$000C0009,$000C0009,$000C0009,$000C000A
	DC.L $000D0000,$000D0002,$000D0003,$000D0004,$000D0005,$000D0006
	DC.L $000D0007,$000D0008,$000D0008,$000D0009,$00000000,$00000000
	DC.L $00000000,$00000000,$00000000,$00000000,$00000000,$00000000
	DC.L $00000000,$00000000,$00000000,$00000000,$00000000,$00000000
	DC.L $00000000,$00000000,$00000000,$00000000,$00000000,$00000000
	DC.L $00000000,$00000000,$00000000,$00000000



PSG	DC.L $0000000F,$000100FF,$000200FF,$000300FF,$000400FF,$000500FF
	DC.L $00060000,$0007003F,$00080000,$00090000,$000A0000,$FFFFFFFF
	



* SUBRUTINA PARA CARGAR FICHEROS CON SAMPLING 
* DEL SAMPLEDITOR.SE DEBEN DE BORRAR LOS NOMBRES
* QUE APAREZCAN CON 
* 	DC.B "____________",0
* Y SUSTITUIRLOS CON
* 	DC.B 0,0
* EN LA LISTA DE DIRECCIONES,SOBRAN TODOS LOS
* 	DC.L $00000,$00000
* SOLO ES NECESARIO UNO DE ELLOS AL FINAL DE 
* LA LISTA!!!
* LA ETIQUETA "DIRECC".LIBRE DEBE APUNTAR A LA 
* MEMORIA LIBRE (VALOR PAR!!!)
* EN CASO DE ERROR LA RUTINA VUELVE Y AVISA.

* (C)1989 RUTINAS Y TABLAS POR EL CANAL 23

LOADSAM	
	MOVEM.L D0-D7/A0-A6,-(A7)
	MOVE.L #NOMBRES,NOMPUN
	MOVE.L #DIRECC,DIRPUN
REICARG	MOVE.L NOMPUN,A0
	TST.B (A0)
	BNE.S SICARG
	MOVEM.L (A7)+,D0-D7/A0-A6
	RTS
SICARG	
QUIK	MOVE.W #2,-(A7)
	MOVE.L A0,-(A7)
	ADD.L #13,NOMPUN
	MOVE.W #$3D,-(A7)
	TRAP #1
	ADDQ.L #8,A7
	TST.L D0
	BMI SALERR
	MOVE.W D0,HANDLE
	MOVE.L DIRPUN,A0
	ADDQ.L #8,DIRPUN
	MOVE.L $0(A0),D1
	ADD.L #LIBRE,D1	; LIBRE ES LA DIRECCIONA CARGAR LOS SAMPLINGS
	MOVE.L D1,-(A7)
	MOVE.L $4(A0),-(A7)
	MOVE.W D0,-(A7)
	MOVE.W #$3F,-(A7)
	TRAP #1
	ADD.L #12,A7
	TST.L D0
	BMI SALERR
	MOVE.W HANDLE,-(A7)
	MOVE.W #$3E,-(A7)
	TRAP #1
	ADD.L #4,A7
	BMI SALERR
	BRA REICARG

SALERR	MOVE.L #TEXERR,-(A7)
	MOVE.W #9,-(A7)
	TRAP #1
	ADD.L #6,A7
	MOVE.W #$8,-(A7)
	TRAP #1
	ADD.L #2,A7
	MOVEM.L (A7)+,D0-D7/A0-A6
	MOVEQ #-1,D0
	RTS


	EVEN
NOMPUN	DC.L 0
SPEED	DC.W 10
INICIO	DC.L $40000
LONG	DC.L $15600
CUENTA	DC.L 0
BUF1	DS.L 10

DIRPUN	DC.L 0
HANDLE	DC.W 0
TEXERR	DC.B "Error de carga!!! Pulsa una tecla",0

* ESTOS SON DOS LISTA DE SAMPLINGS Y DIRECCIONES
* TAL Y COMO DEBEN DE IR EN EL PROGRAMA.
	EVEN
NOMBRES
        DC.B "G1.SAM      ",0
        DC.B "G2.SAM      ",0
        DC.B "G3.SAM      ",0
        DC.B "G4.SAM      ",0
        DC.B "G5.SAM      ",0
        DC.B "G6.SAM      ",0
        DC.B "G7.SAM      ",0
        DC.B "G8.SAM      ",0
        DC.B "G9.SAM      ",0
	DC.B 0,0
	EVEN
DIRECC
        dc.l $00000,$0E600
        dc.l $0E600,$10F00
        dc.l $1F500,$0E400
        dc.l $2D900,$0E100
        dc.l $3BA00,$06C00
        dc.l $42600,$1CB00
        dc.l $5F100,$0E400
        dc.l $6D500,$07300
        dc.l $74800,$0E300
        dc.l $00000,$00000
	EVEN
SECUENC
        dc.w $0112,$0000,$E600
        dc.w $0000,$0000,$00F0
        dc.w $0112,$0000,$E600
        dc.w $0912,$0000,$E300
        dc.w $0914,$0000,$E300
        dc.w $0914,$0000,$E300
        dc.w $0914,$0000,$E300
        dc.w $0912,$0000,$E300
        dc.w $0212,$0000,$1B2D
        dc.w $0212,$0000,$1B04
        dc.w $0212,$0001,$0F00
        dc.w $0312,$0000,$E400
        dc.w $0312,$0000,$E400
        dc.w $0312,$0000,$E400
        dc.w $0312,$0000,$E400
        dc.w $0312,$0000,$E400
        dc.w $0512,$0000,$6C00
        dc.w $0612,$0001,$CB00
        dc.w $0612,$0001,$CB00
        dc.w $0612,$0001,$CB00
        dc.w $0612,$0000,$1493
        dc.w $0712,$0000,$E400
        dc.w $0712,$0000,$E400
        dc.w $0712,$0000,$E400
        dc.w $0712,$0000,$81DD
        dc.w $0912,$0000,$E300
        dc.w $0812,$0000,$7300
        dc.w $0812,$0000,$7300
        dc.w $0812,$0000,$7300
        dc.w $0812,$0000,$7300
        dc.w $0112,$0000,$E600
        dc.w $0912,$0000,$E300
        dc.w $0112,$0000,$E600
        dc.w $0912,$0000,$DA77
        dc.w $0212,$0001,$0F00
        dc.w $0312,$0000,$E400
        dc.w $0212,$0001,$0F00
        dc.w $0312,$0000,$8659
        dc.w $0512,$0000,$6C00
        dc.w $0612,$0001,$CB00
        dc.w $0612,$0001,$CB00
        dc.w $0612,$0001,$CB00
        dc.w $0812,$0000,$7300
        dc.w $0812,$0000,$7300
        dc.w $0812,$0000,$7300
        dc.w $0812,$0000,$7300
        dc.w $0712,$0000,$E400
        dc.w $0712,$0000,$E400
        dc.w $0712,$0000,$E400
        dc.w $0712,$0000,$E400
        dc.w $0912,$0000,$E300
        dc.w $0812,$0000,$7300
        dc.w $0812,$0000,$7300
        dc.w $0812,$0000,$7300
        dc.w $0812,$0000,$7300
        dc.w $0912,$0000,$E300
        dc.w $0912,$0000,$E300
        dc.w $0914,$0000,$E300
        dc.w $0914,$0000,$E300
        dc.w $0112,$0000,$E600
        dc.w $0112,$0000,$E600
        dc.w $0612,$0000,$115C
        dc.w $0612,$0000,$13F7
        dc.w $0612,$0000,$1220
        dc.w $0612,$0000,$1046
        dc.w $0612,$0001,$CB00
        dc.w $070A,$0000,$1632
        dc.w $0710,$0000,$1612
        dc.w $0718,$0000,$1731
        dc.w $071E,$0000,$15E8
        dc.w $0724,$0000,$1BAA
        dc.w $0712,$0000,$E400
        dc.w $070E,$0000,$E400
        dc.w $0712,$0000,$E400
        dc.w $0812,$0000,$1381
        dc.w $080A,$0000,$13E2
        dc.w $0822,$0000,$1069
        dc.w $0812,$0000,$1583
        dc.w $0812,$0000,$157A
        dc.w $0812,$0000,$1CDC
        dc.w $0812,$0000,$7300
        dc.w $0812,$0000,$361D
        dc.w $090C,$0000,$1540
        dc.w $090E,$0000,$1791
        dc.w $0910,$0000,$16AB
        dc.w $0912,$0000,$1779
        dc.w $090C,$0000,$18EE
        dc.w $090E,$0000,$1B7D
        dc.w $090C,$0000,$1746
        dc.w $0912,$0000,$E300
        dc.w $0512,$0000,$18D3
        dc.w $0512,$0000,$159A
        dc.w $0512,$0000,$159A
        dc.w $0512,$0000,$362D
        dc.w $0512,$0000,$6C00
        dc.w $0612,$0000,$20A8
        dc.w $0612,$0000,$2440
        dc.w $0612,$0000,$2085
        dc.w $0612,$0000,$899B
        dc.w $0612,$0000,$8746
        dc.w $0612,$0000,$8739
        dc.w $0612,$0001,$CB00
        dc.w $0608,$0000,$19E6
        dc.w $060A,$0000,$1CAC
        dc.w $060C,$0000,$1B7B
        dc.w $060E,$0000,$1B86
        dc.w $0610,$0000,$173C
        dc.w $0612,$0001,$CB00
        dc.w $020A,$0000,$371E
        dc.w $0212,$0000,$3292
        dc.w $020A,$0000,$87D3
        dc.w $0212,$0001,$0F00
        dc.w $0312,$0000,$13A7
        dc.w $0312,$0000,$15AF
        dc.w $0312,$0000,$E400
        dc.w $0312,$0000,$1708
        dc.w $0312,$0000,$1847
        dc.w $0312,$0000,$1637
        dc.w $0312,$0000,$E400
        dc.w $030E,$0000,$E400
        dc.w $0312,$0000,$E400
        dc.w $0124,$0000,$0D7B
        dc.w $0122,$0000,$0FD0
        dc.w $0120,$0000,$1136
        dc.w $0112,$0000,$E600
        dc.w $0112,$0000,$E600
        dc.w $0112,$0000,$1209
        dc.w $0112,$0000,$171E
        dc.w $0112,$0000,$1432
        dc.w $0712,$0000,$4C2F
        dc.w $070A,$0000,$46BD
        dc.w $0712,$0000,$4902
        dc.w $071C,$0000,$5520
        dc.w $070E,$0000,$3B8A
        dc.w $0712,$0000,$E400
        dc.w $0812,$0000,$7300
        dc.w $080E,$0000,$7300
        dc.w $080E,$0000,$7300
        dc.w $080E,$0000,$7300
        dc.w $0412,$0000,$9531
        dc.w $0412,$0000,$E100
        dc.w $0512,$0000,$37DF
        dc.w $0512,$0000,$3838
        dc.w $0512,$0000,$6C00
        dc.w $0000,$0000,$03A1
        dc.w $0000,$0000,$0000
EVEN

LIBRE
